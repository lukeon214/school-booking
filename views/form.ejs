<h1><%= form.title %></h1>
<% if (success) { %><p>âœ… Thanks! Submitted.</p><% } %>

<form method="POST">
  <% fields.forEach(f => {
    const full = f.max_responses && f.usage >= f.max_responses;
  %>
    <label><%= f.label %>:</label><br>
    <% if (full) { %>
      <p><em>FULL</em></p><br>
    <% } else if (f.type === 'text') { %>
      <input required name="field_<%= f.id %>"><br><br>
    <% } else if (f.type === 'textarea') { %>
      <textarea required name="field_<%= f.id %>"></textarea><br><br>
    <% } else if (f.type === 'number') { %>
      <input type="number" required name="field_<%= f.id %>"><br><br>
    <% } else if (f.type === 'choice') {
      JSON.parse(f.choices).forEach(opt => { %>
        <label><input required type="radio" name="field_<%= f.id %>" value="<%= opt %>"> <%= opt %></label><br>
      <% }) %><br>
    <% } else if (f.type === 'checkbox') {
      JSON.parse(f.choices).forEach(opt => { %>
        <label><input type="checkbox" name="field_<%= f.id %>[]" value="<%= opt %>"> <%= opt %></label><br>
      <% }) %><br>
    <% } else if (f.type === 'dropdown') { %>
      <select required name="field_<%= f.id %>">
        <% JSON.parse(f.choices).forEach(opt => { %>
          <option value="<%= opt %>"><%= opt %></option>
        <% }) %>
      </select><br><br>
    <% } %>
  <% }) %>
  <button>Submit</button>
</form>